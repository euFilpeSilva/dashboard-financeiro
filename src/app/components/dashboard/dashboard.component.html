<div class="dashboard-container" [attr.data-theme]="currentTheme">
  
  <!-- Layout CustomizÃ¡vel (Draggable/Widgets) -->
  <div *ngIf="currentTheme === 'customizavel' && !showDadosMensais" class="layout-container layout-customizavel">
    <app-customizable-layout></app-customizable-layout>
  </div>

  <!-- Layout Compacto (Status Bar + Grid) -->
  <div *ngIf="currentTheme === 'compacto' && !showDadosMensais" class="layout-container layout-compacto">
    <!-- Status bar compacto -->
    <div class="compact-status-bar">
      <div class="status-metrics">
        <div class="metric entrada">
          <span class="metric-icon">ğŸ’°</span>
          <span class="metric-value">{{ formatarMoeda(resumo.totalEntradas) }}</span>
          <span class="metric-label">Entradas</span>
        </div>
        <div class="metric despesa">
          <span class="metric-icon">ğŸ’¸</span>
          <span class="metric-value">{{ formatarMoeda(resumo.totalDespesas) }}</span>
          <span class="metric-label">Despesas</span>
        </div>
        <div class="metric saldo">
          <span class="metric-icon">ğŸ“Š</span>
          <span class="metric-value" [ngClass]="getSaldoClass()">{{ formatarMoeda(resumo.saldoPrevisto) }}</span>
          <span class="metric-label">Saldo</span>
        </div>
        <div class="metric alert" *ngIf="despesasVencidas.length > 0">
          <span class="metric-icon">âš ï¸</span>
          <span class="metric-value">{{ despesasVencidas.length }}</span>
          <span class="metric-label">Vencidas</span>
        </div>
      </div>
      <div class="status-actions">
        <button class="compact-btn primary" (click)="irParaGestao()">+ Nova</button>
        <button class="compact-btn secondary" (click)="mostrarDadosMensais()">Detalhes</button>
      </div>
    </div>

    <!-- Grid compacto principal -->
    <div class="compact-grid">
      <!-- Card de despesas -->
      <div class="compact-card despesas-compact">
        <div class="compact-header">
          <h4>ğŸ“‹ Despesas</h4>
          <span class="count-badge">{{ despesasDoMes.length }}</span>
        </div>
        <div class="compact-content">
          <div class="despesas-mini-list">
            <div *ngFor="let despesa of despesasDoMes.slice(0, 6)" 
                 class="mini-despesa" 
                 [ngClass]="getDespesaStatusClass(despesa)">
              <span class="mini-icon">{{ despesa.categoria.icon }}</span>
              <span class="mini-desc">{{ despesa.descricao }}</span>
              <span class="mini-value">{{ formatarMoeda(despesa.valor) }}</span>
              <span class="mini-status">{{ despesa.paga ? 'âœ…' : 'â³' }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Card de grÃ¡fico -->
      <div class="compact-card chart-compact">
        <div class="compact-header">
          <h4>ğŸ“Š Categorias</h4>
        </div>
        <div class="compact-content">
          <app-chart [despesasPorCategoria]="despesasPorCategoria" chartType="doughnut"></app-chart>
        </div>
      </div>

      <!-- Card de estatÃ­sticas -->
      <div class="compact-card stats-compact">
        <div class="compact-header">
          <h4>ğŸ“ˆ Resumo</h4>
        </div>
        <div class="compact-content">
          <div class="stats-grid">
            <div class="stat-item">
              <span class="stat-number">{{ contarDespesasPagas() }}</span>
              <span class="stat-label">Pagas</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">{{ contarDespesasPendentes() }}</span>
              <span class="stat-label">Pendentes</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">{{ despesasVencidas.length }}</span>
              <span class="stat-label">Vencidas</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Card de entradas -->
      <div class="compact-card entradas-compact">
        <div class="compact-header">
          <h4>ğŸ’° Entradas</h4>
          <span class="count-badge">{{ entradasDoMes.length }}</span>
        </div>
        <div class="compact-content">
          <div class="entradas-mini-list">
            <div *ngFor="let entrada of entradasDoMes.slice(0, 4)" class="mini-entrada">
              <span class="entrada-fonte">{{ entrada.fonte }}</span>
              <span class="entrada-valor">{{ formatarMoeda(entrada.valor) }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Card de alertas e notificaÃ§Ãµes -->
      <div class="compact-card alerts-compact">
        <div class="compact-header">
          <h4>âš ï¸ Alertas</h4>
          <span class="count-badge" *ngIf="getTotalAlertas() > 0">{{ getTotalAlertas() }}</span>
        </div>
        <div class="compact-content">
          <div class="alerts-mini-list">
            <!-- Despesas vencidas -->
            <div *ngFor="let despesa of despesasVencidas.slice(0, 2)" class="mini-alert vencida">
              <span class="alert-icon">ğŸ”´</span>
              <div class="alert-info">
                <span class="alert-desc">{{ despesa.descricao }}</span>
                <span class="alert-detail">Venceu {{ getDiasVencimento(despesa) }}</span>
              </div>
              <span class="alert-value">{{ formatarMoeda(despesa.valor) }}</span>
            </div>
            
            <!-- Despesas prÃ³ximas ao vencimento -->
            <div *ngFor="let despesa of despesasProximasVencimento.slice(0, 2)" class="mini-alert proxima">
              <span class="alert-icon">ğŸŸ¡</span>
              <div class="alert-info">
                <span class="alert-desc">{{ despesa.descricao }}</span>
                <span class="alert-detail">Vence em {{ getDiasParaVencimento(despesa) }}</span>
              </div>
              <span class="alert-value">{{ formatarMoeda(despesa.valor) }}</span>
            </div>
            
            <!-- Meta de gastos (se aplicÃ¡vel) -->
            <div *ngIf="getPercentualGastoMes() > 80" class="mini-alert meta">
              <span class="alert-icon">ğŸ“Š</span>
              <div class="alert-info">
                <span class="alert-desc">Meta de gastos</span>
                <span class="alert-detail">{{ getPercentualGastoMes() }}% do orÃ§amento</span>
              </div>
              <span class="alert-value">{{ formatarMoeda(resumo.totalDespesas) }}</span>
            </div>
            
            <!-- Quando nÃ£o hÃ¡ alertas -->
            <div *ngIf="getTotalAlertas() === 0" class="no-alerts">
              <span class="no-alert-icon">âœ…</span>
              <span class="no-alert-text">Tudo em dia!</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Layout ClÃ¡ssico (Sidebar + Main Content) -->
  <div *ngIf="currentTheme === 'classico' && !showDadosMensais" class="layout-container layout-classico">
    <div class="classico-wrapper">
      
      <!-- Sidebar clÃ¡ssica -->
      <aside class="classico-sidebar">
        <!-- Resumo financeiro -->
        <div class="sidebar-section financial-summary">
          <h3>ğŸ’° Resumo Financeiro</h3>
          <div class="summary-items">
            <div class="summary-item entrada">
              <div class="summary-icon">ğŸ’µ</div>
              <div class="summary-data">
                <span class="summary-label">Entradas</span>
                <span class="summary-value positive">{{ formatarMoeda(resumo.totalEntradas) }}</span>
              </div>
            </div>
            <div class="summary-item despesa">
              <div class="summary-icon">ğŸ’³</div>
              <div class="summary-data">
                <span class="summary-label">Despesas</span>
                <span class="summary-value negative">{{ formatarMoeda(resumo.totalDespesas) }}</span>
              </div>
            </div>
            <div class="summary-item saldo">
              <div class="summary-icon">ğŸ“Š</div>
              <div class="summary-data">
                <span class="summary-label">Saldo</span>
                <span class="summary-value" [ngClass]="getSaldoClass()">{{ formatarMoeda(resumo.saldoPrevisto) }}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- NavegaÃ§Ã£o -->
        <div class="sidebar-section navigation">
          <h3>ğŸ§­ NavegaÃ§Ã£o</h3>
          <div class="nav-buttons">
            <button class="nav-btn" (click)="irParaGestao()">
              <span class="nav-icon">ğŸ“‹</span>
              <span class="nav-text">Gerenciar</span>
            </button>
            <button class="nav-btn" (click)="mostrarDadosMensais()">
              <span class="nav-icon">ğŸ“ˆ</span>
              <span class="nav-text">RelatÃ³rios</span>
            </button>
          </div>
        </div>

        <!-- Alertas -->
        <div class="sidebar-section alerts" *ngIf="despesasVencidas.length > 0">
          <h3>âš ï¸ Alertas</h3>
          <div class="alert-list">
            <div *ngFor="let despesa of despesasVencidas.slice(0, 3)" class="alert-item">
              <span class="alert-badge">VENCIDA</span>
              <span class="alert-desc">{{ despesa.descricao }}</span>
              <span class="alert-value">{{ formatarMoeda(despesa.valor) }}</span>
            </div>
          </div>
        </div>

        <!-- EstatÃ­sticas -->
        <div class="sidebar-section stats">
          <h3>ğŸ“Š EstatÃ­sticas</h3>
          <div class="stats-grid">
            <div class="stat-card">
              <span class="stat-value">{{ contarDespesasPagas() }}</span>
              <span class="stat-label">Pagas</span>
            </div>
            <div class="stat-card">
              <span class="stat-value">{{ contarDespesasPendentes() }}</span>
              <span class="stat-label">Pendentes</span>
            </div>
            <div class="stat-card">
              <span class="stat-value">{{ despesasPorCategoria.length }}</span>
              <span class="stat-label">Categorias</span>
            </div>
          </div>
        </div>
      </aside>

      <!-- ConteÃºdo principal clÃ¡ssico -->
      <main class="classico-main">
        <!-- Header -->
        <div class="main-header">
          <div class="header-content">
            <h1>Dashboard Financeiro</h1>
            <p>VisÃ£o geral de suas finanÃ§as pessoais</p>
          </div>
          <div class="header-actions">
            <button class="classico-btn primary" (click)="irParaGestao()">+ Nova Despesa</button>
            <button class="classico-btn secondary" (click)="mostrarDadosMensais()">ğŸ“Š RelatÃ³rios</button>
          </div>
        </div>

        <!-- ConteÃºdo principal -->
        <div class="main-content">
          <!-- GrÃ¡fico principal -->
          <div class="main-card chart-card">
            <div class="card-header">
              <h3>ğŸ“Š DistribuiÃ§Ã£o por Categoria</h3>
            </div>
            <div class="card-content">
              <app-chart [despesasPorCategoria]="despesasPorCategoria" chartType="pie"></app-chart>
            </div>
          </div>

          <!-- Tabela de despesas -->
          <div class="main-card table-card">
            <div class="card-header">
              <h3>ğŸ“‹ Registro de Despesas</h3>
              <span class="card-subtitle">{{ despesasDoMes.length }} registros</span>
            </div>
            <div class="card-content">
              <div class="classico-table">
                <div class="table-header">
                  <span>Categoria</span>
                  <span>DescriÃ§Ã£o</span>
                  <span>Valor</span>
                  <span>Status</span>
                </div>
                <div *ngFor="let despesa of despesasDoMes.slice(0, 8)" 
                     class="table-row" 
                     [ngClass]="getDespesaStatusClass(despesa)">
                  <span class="table-cell categoria">
                    <span class="categoria-icon">{{ despesa.categoria.icon }}</span>
                    {{ despesa.categoria.nome }}
                  </span>
                  <span class="table-cell">{{ despesa.descricao }}</span>
                  <span class="table-cell">{{ formatarMoeda(despesa.valor) }}</span>
                  <span class="table-cell">
                    <span class="status-badge" [ngClass]="despesa.paga ? 'paid' : 'pending'">
                      {{ despesa.paga ? 'Pago' : 'Pendente' }}
                    </span>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>

  <!-- VisualizaÃ§Ã£o de Dados Mensais (comum para todos os layouts) -->
  <div *ngIf="showDadosMensais" class="monthly-data-view">
    
    <div class="monthly-header">
      <div class="title-section">
        <h2>ğŸ“… DADOS POR MÃŠS</h2>
        <p class="subtitle">Visualize dados organizados por perÃ­odo</p>
      </div>
      
      <div class="visualization-selector">
        <label>VisualizaÃ§Ã£o:</label>
        <select (change)="alterarVisualizacao(tiposVisualizacao[+($any($event.target).value)])" class="select-visualization">
          <option *ngFor="let tipo of tiposVisualizacao; let i = index" [value]="i" [selected]="visualizacaoAtiva.id === tipo.id">
            {{ tipo.nome }}
          </option>
        </select>
      </div>

      <!-- BotÃ£o para voltar ao dashboard -->
      <div class="back-section">
        <button class="back-btn" (click)="voltarAoDashboard()">â† Voltar ao Dashboard</button>
      </div>
    </div>

    <!-- VisualizaÃ§Ã£o Detalhada -->
    <div *ngIf="visualizacaoAtiva.id === 'detalhada'" class="detailed-view">
      
      <!-- Seletores de perÃ­odo -->
      <div class="period-selectors">
        <div class="selector-group">
          <label>MÃªs:</label>
          <select [(ngModel)]="mesSelecionado" (change)="alterarMesSelecionado()" class="period-select">
            <option *ngFor="let mes of meses" [value]="mes.valor">{{ mes.nome }}</option>
          </select>
        </div>
        
        <div class="selector-group">
          <label>Ano:</label>
          <select [(ngModel)]="anoSelecionado" (change)="alterarAnoSelecionado()" class="period-select">
            <option *ngFor="let ano of anos" [value]="ano">{{ ano }}</option>
          </select>
        </div>
      </div>

      <!-- Resumo do mÃªs -->
      <div class="month-summary">
        <h3>ğŸ“Š {{ getNomeMesSelecionado() }} de {{ anoSelecionado }}</h3>
        
        <div class="summary-cards">
          <div class="summary-card entrada">
            <div class="card-icon">ğŸ’°</div>
            <div class="card-content">
              <span class="card-label">Entradas</span>
              <span class="card-value">{{ formatarMoeda(resumoMesDetalhado.totalEntradas) }}</span>
            </div>
          </div>
          
          <div class="summary-card despesa">
            <div class="card-icon">ğŸ’¸</div>
            <div class="card-content">
              <span class="card-label">Despesas</span>
              <span class="card-value">{{ formatarMoeda(resumoMesDetalhado.totalDespesas) }}</span>
            </div>
          </div>
          
          <div class="summary-card saldo" [ngClass]="resumoMesDetalhado.saldo >= 0 ? 'positive' : 'negative'">
            <div class="card-icon">{{ resumoMesDetalhado.saldo >= 0 ? 'ğŸ“ˆ' : 'ğŸ“‰' }}</div>
            <div class="card-content">
              <span class="card-label">Saldo</span>
              <span class="card-value">{{ formatarMoeda(resumoMesDetalhado.saldo) }}</span>
            </div>
          </div>
        </div>

        <!-- Status das despesas -->
        <div class="status-summary">
          <div class="status-item paid">
            <span class="status-number">{{ resumoMesDetalhado.despesasPagas }}</span>
            <span class="status-label">Pagas</span>
          </div>
          <div class="status-item pending">
            <span class="status-number">{{ resumoMesDetalhado.despesasPendentes }}</span>
            <span class="status-label">Pendentes</span>
          </div>
          <div class="status-item overdue">
            <span class="status-number">{{ resumoMesDetalhado.despesasVencidas }}</span>
            <span class="status-label">Vencidas</span>
          </div>
        </div>
      </div>

      <!-- Listas detalhadas -->
      <div class="detailed-lists">
        
        <!-- Lista de entradas -->
        <div class="list-section" *ngIf="entradasDoMesDetalhado.length > 0">
          <h4>ğŸ’° Entradas de {{ getNomeMesSelecionado() }}</h4>
          <div class="items-list">
            <div *ngFor="let entrada of entradasDoMesDetalhado" class="list-item entrada">
              <div class="item-info">
                <span class="item-description">{{ entrada.descricao }}</span>
                <span class="item-source">{{ entrada.fonte }}</span>
              </div>
              <div class="item-values">
                <span class="item-date">{{ entrada.data | date:'dd/MM' }}</span>
                <span class="item-amount positive">{{ formatarMoeda(entrada.valor) }}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Lista de despesas -->
        <div class="list-section" *ngIf="despesasDoMesDetalhado.length > 0">
          <h4>ğŸ’¸ Despesas de {{ getNomeMesSelecionado() }}</h4>
          <div class="items-list">
            <div *ngFor="let despesa of despesasDoMesDetalhado" class="list-item despesa">
              <div class="item-info">
                <span class="item-description">{{ despesa.descricao }}</span>
                <span class="item-category">{{ despesa.categoria.icon }} {{ despesa.categoria.nome }}</span>
              </div>
              <div class="item-values">
                <span class="item-date">{{ despesa.dataVencimento | date:'dd/MM' }}</span>
                <span class="item-status" [ngClass]="despesa.paga ? 'paid' : 'pending'">
                  {{ despesa.paga ? 'âœ…' : 'â³' }}
                </span>
                <span class="item-amount negative">{{ formatarMoeda(despesa.valor) }}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Mensagem sem dados -->
        <div *ngIf="entradasDoMesDetalhado.length === 0 && despesasDoMesDetalhado.length === 0" class="no-data">
          <div class="no-data-icon">ğŸ“­</div>
          <h4>Nenhum dado encontrado</h4>
          <p>NÃ£o hÃ¡ entradas ou despesas registradas para {{ getNomeMesSelecionado() }} de {{ anoSelecionado }}.</p>
        </div>
      </div>
    </div>

    <!-- VisualizaÃ§Ã£o Resumida -->
    <div *ngIf="visualizacaoAtiva.id === 'resumida'" class="summary-view">
      <!-- ConteÃºdo da visualizaÃ§Ã£o resumida mantido do original -->
      
      <!-- GrÃ¡fico Comparativo -->
      <section class="comparative-chart">
        <h3>Comparativo Mensal - Entradas vs Despesas</h3>
        <app-chart-bar></app-chart-bar>
      </section>

      <!-- Cards mensais -->
      <section class="monthly-cards">
        <div *ngFor="let dado of dadosMensais" class="monthly-card">
          <div class="monthly-header">
            <h4>{{ dado.descricao }}</h4>
            <div class="monthly-values">
              <span class="income">+{{ formatarMoeda(dado.entradas) }}</span>
              <span class="expense">-{{ formatarMoeda(dado.despesas) }}</span>
            </div>
          </div>
          
          <div class="monthly-body">
            <div class="financial-item">
              <span class="label">Entradas:</span>
              <span class="value positive">{{ formatarMoeda(dado.entradas) }}</span>
            </div>
            
            <div class="financial-item">
              <span class="label">Despesas:</span>
              <span class="value negative">{{ formatarMoeda(dado.despesas) }}</span>
            </div>
            
            <div class="financial-item balance">
              <span class="label">Saldo:</span>
              <span class="value" [ngClass]="dado.saldo >= 0 ? 'positive' : 'negative'">
                {{ formatarMoeda(dado.saldo) }}
              </span>
            </div>
          </div>
        </div>
      </section>

      <!-- Destaques mensais -->
      <section class="monthly-highlights">
        <h3>ğŸ“ˆ Destaques do MÃªs</h3>
        <div class="highlights-grid">
          <div *ngFor="let destaque of destaquesMensais" class="highlight-item">
            <div class="highlight-value">{{ formatarMoeda(destaque.valor) }}</div>
            <div class="highlight-label">{{ destaque.descricao }}</div>
            <small class="highlight-month">{{ destaque.mes }}</small>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- Dashboard Principal (apenas quando nÃ£o estÃ¡ na visualizaÃ§Ã£o mensal) -->
  <div *ngIf="!showDadosMensais && currentTheme !== 'compacto' && currentTheme !== 'classico' && currentTheme !== 'customizavel'" class="main-dashboard">
    <!-- ConteÃºdo do dashboard padrÃ£o mantido para compatibilidade -->
    
    <!-- Cards de Resumo -->
    <section class="summary-cards">
      <div class="card card-entradas">
        <div class="card-icon">ğŸ’°</div>
        <div class="card-content">
          <h3>Entradas</h3>
          <p class="card-value">{{ formatarMoeda(resumo.totalEntradas) }}</p>
        </div>
      </div>

      <div class="card card-saldo">
        <div class="card-icon">ğŸ“Š</div>
        <div class="card-content">
          <h3>Saldo Previsto</h3>
          <p class="card-value" [ngClass]="getSaldoClass()">{{ formatarMoeda(resumo.saldoPrevisto) }}</p>
        </div>
      </div>

      <div class="card card-despesas">
        <div class="card-icon">ğŸ’³</div>
        <div class="card-content">
          <h3>Total Despesas</h3>
          <p class="card-value">{{ formatarMoeda(resumo.totalDespesas) }}</p>
        </div>
      </div>
    </section>

    <!-- Alertas -->
    <div *ngIf="despesasProximasVencimento.length > 0" class="alertas proximas">
      <h4>ğŸ”” PrÃ³ximas ao Vencimento</h4>
      <div *ngFor="let despesa of despesasProximasVencimento" class="alerta-item proxima">
        {{ despesa.descricao }} - {{ formatarMoeda(despesa.valor) }} - Vence: {{ formatarData(despesa.dataVencimento) }}
      </div>
    </div>

    <!-- ConteÃºdo Principal -->
    <div class="main-content">
      <!-- Cards lado a lado -->
      <div class="cards-lado-a-lado">
        <!-- Card do GrÃ¡fico de Despesas -->
        <section class="card-grafico">
          <div class="card-body">
            <app-chart [despesasPorCategoria]="despesasPorCategoria" chartType="pie"></app-chart>
          </div>
        </section>

        <!-- Card das Despesas do MÃªs -->
        <section class="card-despesas-mes">
          <div class="card-header">
            <h3>ğŸ“‹ Despesas do MÃªs Atual</h3>
            <div class="card-actions">
              <div class="view-toggle">
                <button 
                  class="toggle-btn" 
                  [class.active]="modoVisualizacaoDespesas === 'grade'"
                  (click)="alterarVisualizacaoDespesas('grade')"
                  title="VisualizaÃ§Ã£o em Grade">
                  âŠ Grade
                </button>
                <button 
                  class="toggle-btn" 
                  [class.active]="modoVisualizacaoDespesas === 'lista'"
                  (click)="alterarVisualizacaoDespesas('lista')"
                  title="VisualizaÃ§Ã£o em Lista">
                  â˜° Lista
                </button>
              </div>
              <span class="total-count">{{ despesasDoMes.length }} despesas</span>
              <button class="btn btn-primary" (click)="irParaGestao()">â• Nova Despesa</button>
            </div>
          </div>
          
          <div class="card-body">
            <!-- VisualizaÃ§Ã£o em Grade -->
            <div *ngIf="modoVisualizacaoDespesas === 'grade'">
              <div class="despesas-grid-otimizada" *ngIf="despesasDoMes.length > 0; else noDespesas">
                <div *ngFor="let despesa of despesasDoMes" class="despesa-card-compact" [ngClass]="getDespesaStatusClass(despesa)">
                <div class="despesa-header-compact">
                  <div class="categoria-info">
                    <div class="categoria-icon-compact" [style.background-color]="despesa.categoria.cor">
                      {{ despesa.categoria.icon || 'ğŸ’³' }}
                    </div>
                    <span class="categoria-nome-compact">{{ despesa.categoria.nome }}</span>
                  </div>
                  
                  <div class="despesa-actions-compact">
                    <button class="action-btn-compact edit-btn" (click)="editarDespesa(despesa)" title="Editar">
                      âœï¸
                    </button>
                    <button class="action-btn-compact delete-btn" (click)="excluirDespesa(despesa)" title="Excluir">
                      ğŸ—‘ï¸
                    </button>
                  </div>
                </div>
                
                <div class="despesa-body-compact">
                  <h4 class="despesa-descricao-compact" [title]="despesa.descricao">{{ despesa.descricao }}</h4>
                  
                  <div class="info-grid">
                    <div class="info-row">
                      <span class="info-label-compact">ğŸ’°</span>
                      <span class="info-value-compact valor">{{ formatarMoeda(despesa.valor) }}</span>
                    </div>
                    
                    <div class="info-row">
                      <span class="info-label-compact">ğŸ“…</span>
                      <span class="info-value-compact" [ngClass]="getVencimentoClass(despesa)">
                        {{ formatarData(despesa.dataVencimento) }}
                      </span>
                    </div>
                    
                    <div class="info-row">
                      <span class="info-label-compact">âš¡</span>
                      <span class="info-value-compact prioridade-compact" [ngClass]="getPrioridadeClass(despesa.prioridade)">
                        {{ getPrioridadeTexto(despesa.prioridade) }}
                      </span>
                    </div>
                  </div>
                  
                  <div class="status-footer">
                    <button class="status-toggle-compact" 
                            [ngClass]="despesa.paga ? 'pago' : 'pendente'"
                            (click)="toggleStatusPagamento(despesa)">
                      <span class="status-icon-compact">{{ despesa.paga ? 'âœ…' : 'â³' }}</span>
                      <span class="status-text-compact">{{ despesa.paga ? 'Pago' : 'Pendente' }}</span>
                    </button>
                  </div>
                </div>
              </div>
              </div>
            </div>

            <!-- VisualizaÃ§Ã£o em Lista -->
            <div *ngIf="modoVisualizacaoDespesas === 'lista'">
              <div class="despesas-lista" *ngIf="despesasDoMes.length > 0; else noDespesas">
              <div class="lista-header">
                <div class="header-col col-categoria">Categoria</div>
                <div class="header-col col-descricao">DescriÃ§Ã£o</div>
                <div class="header-col col-valor">Valor</div>
                <div class="header-col col-vencimento">Vencimento</div>
                <div class="header-col col-prioridade">Prioridade</div>
                <div class="header-col col-status">Status</div>
                <div class="header-col col-acoes">AÃ§Ãµes</div>
              </div>
              
              <div class="lista-body">
                <div *ngFor="let despesa of despesasDoMes" class="despesa-row" [ngClass]="getDespesaStatusClass(despesa)">
                  <div class="row-col col-categoria">
                    <div class="categoria-compact">
                      <div class="categoria-icon-small" [style.background-color]="despesa.categoria.cor">
                        {{ despesa.categoria.icon || 'ğŸ’³' }}
                      </div>
                      <span class="categoria-nome-small">{{ despesa.categoria.nome }}</span>
                    </div>
                  </div>
                  
                  <div class="row-col col-descricao">
                    <span class="despesa-descricao-compact" [title]="despesa.descricao">
                      {{ despesa.descricao }}
                    </span>
                  </div>
                  
                  <div class="row-col col-valor">
                    <span class="valor-compact">{{ formatarMoeda(despesa.valor) }}</span>
                  </div>
                  
                  <div class="row-col col-vencimento">
                    <span class="vencimento-compact" [ngClass]="getVencimentoClass(despesa)">
                      {{ formatarData(despesa.dataVencimento) }}
                    </span>
                  </div>
                  
                  <div class="row-col col-prioridade">
                    <span class="prioridade-compact" [ngClass]="getPrioridadeClass(despesa.prioridade)">
                      {{ getPrioridadeTexto(despesa.prioridade) }}
                    </span>
                  </div>
                  
                  <div class="row-col col-status">
                    <button class="status-toggle-compact" 
                            [ngClass]="despesa.paga ? 'pago' : 'pendente'"
                            (click)="toggleStatusPagamento(despesa)"
                            [title]="despesa.paga ? 'Despesa paga' : 'Marcar como pago'">
                      <span class="status-icon-compact">{{ despesa.paga ? 'âœ…' : 'â³' }}</span>
                    </button>
                  </div>
                  
                  <div class="row-col col-acoes">
                    <div class="acoes-compact">
                      <button class="action-btn-compact edit-btn" (click)="editarDespesa(despesa)" title="Editar">
                        âœï¸
                      </button>
                      <button class="action-btn-compact delete-btn" (click)="excluirDespesa(despesa)" title="Excluir">
                        ğŸ—‘ï¸
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              </div>
            </div>
            
            <ng-template #noDespesas>
              <div class="no-despesas">
                <div class="no-despesas-icon">ğŸ“</div>
                <h4>Nenhuma despesa cadastrada</h4>
                <p>Adicione suas despesas para comeÃ§ar o controle financeiro</p>
                <button class="btn btn-primary" (click)="irParaGestao()">â• Adicionar Primeira Despesa</button>
              </div>
            </ng-template>
          </div>
        </section>
      </div>

    <!-- Alertas de Vencimento -->
    <div *ngIf="despesasVencidas.length > 0" class="alertas vencidas">
      <h4>âš ï¸ Despesas Vencidas</h4>
      <div *ngFor="let despesa of despesasVencidas" class="alerta-item vencida">
        {{ despesa.descricao }} - {{ formatarMoeda(despesa.valor) }}
      </div>
    </div>

    <!-- Mural de AnotaÃ§Ãµes -->
    <section class="mural-anotacoes" [class.minimizado]="!mostrarMuralAnotacoes">
      <div class="mural-header">
        <div class="mural-title">
          <h3>ğŸ“ Mural de AnotaÃ§Ãµes</h3>
          <span class="contador-anotacoes">{{ anotacoes.length }} anotaÃ§Ãµes</span>
        </div>
        <div class="mural-controls">
          <button 
            class="btn-toggle-mural" 
            (click)="toggleMuralAnotacoes()"
            [title]="mostrarMuralAnotacoes ? 'Minimizar mural' : 'Expandir mural'">
            {{ mostrarMuralAnotacoes ? 'â–¼' : 'â–¶' }}
          </button>
        </div>
      </div>

      <div *ngIf="mostrarMuralAnotacoes" class="mural-content">
        <!-- FormulÃ¡rio para nova anotaÃ§Ã£o -->
        <div class="nova-anotacao-form">
          <div class="input-group">
            <textarea 
              [(ngModel)]="novaAnotacao"
              placeholder="Digite sua anotaÃ§Ã£o aqui... (Ctrl+Enter para salvar)"
              class="nova-anotacao-input"
              rows="3"
              maxlength="500"
              (keydown.control.enter)="adicionarAnotacao()">
            </textarea>
            <div class="input-actions">
              <span class="char-counter">{{ novaAnotacao.length }}/500</span>
              <button 
                class="btn btn-primary btn-add-anotacao" 
                (click)="adicionarAnotacao()"
                [disabled]="!novaAnotacao.trim()">
                â• Adicionar
              </button>
            </div>
          </div>
        </div>

        <!-- Lista de anotaÃ§Ãµes -->
        <div class="anotacoes-container" *ngIf="anotacoes.length > 0; else semAnotacoes">
          <div 
            *ngFor="let anotacao of anotacoes; trackBy: trackByAnotacao" 
            class="anotacao-card"
            [style.border-left-color]="anotacao.cor">
            
            <!-- Modo visualizaÃ§Ã£o -->
            <div *ngIf="editandoAnotacao !== anotacao.id" class="anotacao-view">
              <div class="anotacao-content">
                <p class="anotacao-texto">{{ anotacao.texto }}</p>
                <div class="anotacao-meta">
                  <span class="anotacao-data">{{ formatarDataHora(anotacao.dataHora) }}</span>
                  <div class="anotacao-actions">
                    <button 
                      class="btn-action edit" 
                      (click)="iniciarEdicao(anotacao)"
                      title="Editar anotaÃ§Ã£o">
                      âœï¸
                    </button>
                    <button 
                      class="btn-action delete" 
                      (click)="removerAnotacao(anotacao.id)"
                      title="Remover anotaÃ§Ã£o">
                      ğŸ—‘ï¸
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Modo ediÃ§Ã£o -->
            <div *ngIf="editandoAnotacao === anotacao.id" class="anotacao-edit">
              <textarea 
                [(ngModel)]="textoEdicao"
                class="edit-textarea"
                rows="3"
                maxlength="500"
                (keydown.control.enter)="salvarEdicao()"
                (keydown.escape)="cancelarEdicao()">
              </textarea>
              <div class="edit-actions">
                <span class="char-counter">{{ textoEdicao.length }}/500</span>
                <div class="edit-buttons">
                  <button 
                    class="btn btn-success btn-sm" 
                    (click)="salvarEdicao()"
                    [disabled]="!textoEdicao.trim()">
                    âœ… Salvar
                  </button>
                  <button 
                    class="btn btn-secondary btn-sm" 
                    (click)="cancelarEdicao()">
                    âŒ Cancelar
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Estado vazio -->
        <ng-template #semAnotacoes>
          <div class="sem-anotacoes">
            <div class="sem-anotacoes-icon">ğŸ“‹</div>
            <h4>Nenhuma anotaÃ§Ã£o ainda</h4>
            <p>Adicione suas primeiras anotaÃ§Ãµes para organizar ideias e lembretes</p>
          </div>
        </ng-template>
      </div>
    </section>
  </div>
</div>